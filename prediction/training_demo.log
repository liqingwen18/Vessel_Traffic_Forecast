2025-06-29 19:47:22,405 - run_training_demo - INFO - 开始运行STA-BiLSTM模型训练流程（演示版）
2025-06-29 19:47:22,407 - run_training_demo - INFO - 开始数据处理...
2025-06-29 19:47:22,407 - run_training_demo - INFO - 加载H3网格和邻接关系...
2025-06-29 19:47:22,409 - run_training_demo - INFO - 加载了 136 个H3网格
2025-06-29 19:47:22,409 - run_training_demo - INFO - 构建H3网格邻接图...
2025-06-29 19:47:22,410 - root - INFO - 构建H3网格邻接图...
2025-06-29 19:47:22,411 - root - INFO - 构建了492条边的H3网格邻接图
2025-06-29 19:47:22,411 - run_training_demo - INFO - 构建了 492 条边的邻接图
2025-06-29 19:47:22,411 - run_training_demo - INFO - 加载聚合网格数据: prediction/demo_data\demo_grid_data.csv
2025-06-29 19:47:22,569 - run_training_demo - INFO - 数据集包含 2016 个时间步
2025-06-29 19:47:22,569 - run_training_demo - INFO - 创建时间序列数据...
2025-06-29 19:47:28,611 - run_training_demo - INFO - 时间序列数据形状: X=(1999, 12, 136, 1), y=(1999, 6, 136, 1)
2025-06-29 19:47:28,611 - run_training_demo - INFO - 训练集大小: 1599个样本, 验证集大小: 400个样本
2025-06-29 19:47:28,613 - run_training_demo - INFO - 标准化数据...
2025-06-29 19:47:28,665 - run_training_demo - INFO - 创建数据加载器...
2025-06-29 19:47:28,674 - data_loader - INFO - 创建数据集: 1599 个样本, 12 个时间步, 136 个节点
2025-06-29 19:47:28,676 - data_loader - INFO - 创建数据集: 400 个样本, 12 个时间步, 136 个节点
2025-06-29 19:47:28,676 - run_training_demo - INFO - 演示数据准备完成
2025-06-29 19:47:28,681 - run_training_demo - INFO - 数据加载完成: 136 个H3网格
2025-06-29 19:47:28,681 - run_training_demo - INFO - 训练批次数: 100, 验证批次数: 25
2025-06-29 19:47:28,682 - run_training_demo - INFO - 开始模型训练...
2025-06-29 19:47:28,768 - train - INFO - 开始训练STA-BiLSTM模型... 设备: cpu
2025-06-29 19:47:28,771 - root - INFO - 模型配置已保存至: prediction/saved_models\model_config.json
2025-06-29 21:16:18,300 - train - INFO - Epoch 1/10 - Time: 5329.53s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-29 21:16:18,353 - train - INFO - 保存最佳模型，验证损失: 91.6605
2025-06-29 23:00:47,864 - train - INFO - Epoch 2/10 - Time: 6269.51s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-29 23:00:47,866 - train - INFO - 验证损失未改善，计数器: 1/3
2025-06-30 00:46:11,087 - train - INFO - Epoch 3/10 - Time: 6323.22s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 00:46:11,090 - train - INFO - 验证损失未改善，计数器: 2/3
2025-06-30 02:36:59,280 - train - INFO - Epoch 4/10 - Time: 6648.19s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 02:36:59,280 - train - INFO - 验证损失未改善，计数器: 3/3
2025-06-30 02:36:59,280 - train - INFO - 早停触发！验证损失连续 3 个epoch未改善。
2025-06-30 02:36:59,286 - train - INFO - 训练历史已保存至: prediction/results\training_history.json
2025-06-30 02:37:00,389 - train - INFO - 训练完成！最佳验证损失: 91.6605
2025-06-30 02:37:00,390 - run_training_demo - INFO - 模型训练完成!
2025-06-30 02:37:00,404 - run_training_demo - ERROR - 训练过程发生错误: 'Trainer' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\27015\Desktop\船舶流量\prediction\run_training_demo.py", line 194, in main
    plt.plot(training_history['train_loss'], label='训练损失')
             ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'Trainer' object is not subscriptable
2025-06-30 13:47:24,872 - run_training_demo - INFO - 开始运行STA-BiLSTM模型训练流程（演示版）
2025-06-30 13:47:24,873 - run_training_demo - WARNING - GPU不可用，使用CPU进行训练
2025-06-30 13:47:24,876 - run_training_demo - INFO - 开始数据处理...
2025-06-30 13:47:24,876 - run_training_demo - INFO - 加载H3网格和邻接关系...
2025-06-30 13:47:24,884 - run_training_demo - INFO - 加载了 136 个H3网格
2025-06-30 13:47:24,884 - run_training_demo - INFO - 构建H3网格邻接图...
2025-06-30 13:47:24,885 - root - INFO - 构建H3网格邻接图...
2025-06-30 13:47:24,886 - root - INFO - 构建了492条边的H3网格邻接图
2025-06-30 13:47:24,887 - run_training_demo - INFO - 构建了 492 条边的邻接图
2025-06-30 13:47:24,887 - run_training_demo - INFO - 加载聚合网格数据: prediction/demo_data\demo_grid_data.csv
2025-06-30 13:47:25,090 - run_training_demo - INFO - 数据集包含 2016 个时间步
2025-06-30 13:47:25,090 - run_training_demo - INFO - 创建时间序列数据...
2025-06-30 13:47:31,809 - run_training_demo - INFO - 时间序列数据形状: X=(1999, 12, 136, 1), y=(1999, 6, 136, 1)
2025-06-30 13:47:31,809 - run_training_demo - INFO - 训练集大小: 1599个样本, 验证集大小: 400个样本
2025-06-30 13:47:31,809 - run_training_demo - INFO - 标准化数据...
2025-06-30 13:47:31,859 - run_training_demo - INFO - 创建数据加载器...
2025-06-30 13:47:31,866 - data_loader - INFO - 创建数据集: 1599 个样本, 12 个时间步, 136 个节点
2025-06-30 13:47:31,867 - data_loader - INFO - 创建数据集: 400 个样本, 12 个时间步, 136 个节点
2025-06-30 13:47:31,868 - run_training_demo - INFO - 演示数据准备完成
2025-06-30 13:47:31,875 - run_training_demo - INFO - 数据加载完成: 136 个H3网格
2025-06-30 13:47:31,875 - run_training_demo - INFO - 训练批次数: 100, 验证批次数: 25
2025-06-30 13:47:31,876 - run_training_demo - INFO - 开始模型训练...
2025-06-30 13:47:31,955 - train - INFO - 开始训练STA-BiLSTM模型... 设备: cpu
2025-06-30 13:47:31,958 - root - INFO - 模型配置已保存至: prediction/saved_models\model_config.json
2025-06-30 15:18:23,499 - train - INFO - Epoch 1/10 - Time: 5451.54s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 15:18:23,555 - train - INFO - 保存最佳模型，验证损失: 91.6605
2025-06-30 16:59:04,079 - train - INFO - Epoch 2/10 - Time: 6040.52s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 16:59:04,082 - train - INFO - 验证损失未改善，计数器: 1/3
2025-06-30 18:45:11,178 - train - INFO - Epoch 3/10 - Time: 6367.09s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 18:45:11,181 - train - INFO - 验证损失未改善，计数器: 2/3
2025-06-30 19:32:25,923 - run_training_demo - INFO - 开始运行STA-BiLSTM模型训练流程（演示版）
2025-06-30 19:32:25,929 - run_training_demo - INFO - 开始数据处理...
2025-06-30 19:32:25,930 - run_training_demo - INFO - 加载H3网格和邻接关系...
2025-06-30 19:32:25,938 - run_training_demo - INFO - 加载了 136 个H3网格
2025-06-30 19:32:25,939 - run_training_demo - INFO - 构建H3网格邻接图...
2025-06-30 19:32:25,939 - root - INFO - 构建H3网格邻接图...
2025-06-30 19:32:25,941 - root - INFO - 构建了492条边的H3网格邻接图
2025-06-30 19:32:25,953 - run_training_demo - INFO - 构建了 492 条边的邻接图
2025-06-30 19:32:25,954 - run_training_demo - INFO - 加载聚合网格数据: prediction/demo_data\demo_grid_data.csv
2025-06-30 19:32:26,160 - run_training_demo - INFO - 数据集包含 2016 个时间步
2025-06-30 19:32:26,161 - run_training_demo - INFO - 创建时间序列数据...
2025-06-30 19:32:35,011 - run_training_demo - INFO - 时间序列数据形状: X=(1999, 12, 136, 1), y=(1999, 6, 136, 1)
2025-06-30 19:32:35,012 - run_training_demo - INFO - 训练集大小: 1599个样本, 验证集大小: 400个样本
2025-06-30 19:32:35,012 - run_training_demo - INFO - 标准化数据...
2025-06-30 19:32:35,050 - run_training_demo - INFO - 创建数据加载器...
2025-06-30 19:32:35,059 - data_loader - INFO - 创建数据集: 1599 个样本, 12 个时间步, 136 个节点
2025-06-30 19:32:35,061 - data_loader - INFO - 创建数据集: 400 个样本, 12 个时间步, 136 个节点
2025-06-30 19:32:35,061 - run_training_demo - INFO - 演示数据准备完成
2025-06-30 19:32:35,066 - run_training_demo - INFO - 数据加载完成: 136 个H3网格
2025-06-30 19:32:35,066 - run_training_demo - INFO - 训练批次数: 100, 验证批次数: 25
2025-06-30 19:32:35,067 - run_training_demo - INFO - 开始模型训练...
2025-06-30 19:32:35,369 - train - INFO - 开始训练STA-BiLSTM模型... 设备: cuda
2025-06-30 19:32:35,495 - root - INFO - 模型配置已保存至: prediction/saved_models\model_config.json
2025-06-30 21:18:47,029 - train - INFO - Epoch 1/10 - Time: 6371.53s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 21:18:47,098 - train - INFO - 保存最佳模型，验证损失: 91.6605
2025-06-30 23:00:07,763 - train - INFO - Epoch 2/10 - Time: 6080.66s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-06-30 23:00:07,767 - train - INFO - 验证损失未改善，计数器: 1/3
2025-07-01 00:39:24,686 - train - INFO - Epoch 3/10 - Time: 5956.92s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-07-01 00:39:24,687 - train - INFO - 验证损失未改善，计数器: 2/3
2025-07-01 02:15:30,804 - train - INFO - Epoch 4/10 - Time: 5766.12s - Train Loss: 90.9978 - Val Loss: 91.6605 - Val RMSE: 9.2816 - Val MAE: 7.1901 - Val MAPE: 123919912.50%
2025-07-01 02:15:30,805 - train - INFO - 验证损失未改善，计数器: 3/3
2025-07-01 02:15:30,805 - train - INFO - 早停触发！验证损失连续 3 个epoch未改善。
2025-07-01 02:15:30,813 - train - INFO - 训练历史已保存至: prediction/results\training_history.json
2025-07-01 02:15:32,440 - train - INFO - 训练完成！最佳验证损失: 91.6605
2025-07-01 02:15:32,442 - run_training_demo - INFO - 模型训练完成!
2025-07-01 02:15:33,111 - run_training_demo - INFO - 训练结果已保存至 prediction/results/training_demo_summary.png
2025-07-01 02:15:33,111 - run_training_demo - INFO - 演示训练流程完成
